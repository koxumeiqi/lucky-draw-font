<template>
  <LuckyGrid
    ref="myLucky"
    width="300px"
    height="300px"
    rows="3"
    cols="3"
    :prizes="prizes"
    :default-style="defaultStyle"
    :active-style="activedStyle"
    :buttons="buttons"
    @start="startCallback"
    @end="endCallback"
  />
</template>

<script>
export default {
  data () {
    return {
      buttons: [
        {
          x: 1,
          y: 1,
          shadow: '3',
          imgs: [{
            src: 'raffle-button.png',
            width: '100px',
            height: '100px'
          }]
        }
      ],
      remainTimes: 3,
      defaultStyle: { background: '#b8c5f2' },
      activedStyle: {
        fontColor: 'darkorange',
        fontSize: '24px'
      },
      prizes: [
        {
          x: 0,
          y: 0,
          fonts: [{
            text: '1',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-00.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-00.png'
          }]
        },
        {
          x: 1,
          y: 0,
          fonts: [{
            text: '2',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-01.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-01.png'
          }]
        },
        {
          x: 2,
          y: 0,
          fonts: [{
            text: '3',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-02.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-02.png'
          }]
        },
        {
          x: 2,
          y: 1,
          fonts: [{
            text: '4',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-12.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-12.png'
          }]
        },
        {
          x: 2,
          y: 2,
          fonts: [{
            text: '5',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-22.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-22.png'
          }]
        },
        {
          x: 1,
          y: 2,
          fonts: [{
            text: '6',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-21.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-21.png'
          }]
        },
        {
          x: 0,
          y: 2,
          fonts: [{
            text: '7',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-20.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-20.png'
          }]
        },
        {
          x: 0,
          y: 1,
          fonts: [{
            text: '8',
            top: '80%',
            fontSize: '12px',
            fontWeight: '800'
          }],
          imgs: [{
            src: 'raffle-award-10.png',
            width: '100px',
            height: '100px',
            activeSrc: 'raffle-award-10.png'
          }]
        }
      ]
    }
  },
  mounted () {
  },
  methods: {
    // ç‚¹å‡»æŠ½å¥–æŒ‰é’®ä¼šè§¦å‘starå›è°ƒ
    startCallback () {
      // è°ƒç”¨æŠ½å¥–ç»„ä»¶çš„playæ–¹æ³•å¼€å§‹æ¸¸æˆ
      this.$refs.myLucky.play()
      // æ¨¡æ‹Ÿè°ƒç”¨æ¥å£å¼‚æ­¥æŠ½å¥–
      setTimeout(() => {
        // å‡è®¾åç«¯è¿”å›çš„ä¸­å¥–ç´¢å¼•æ˜¯0
        const index = this.randomRaffleHandle()
        // è°ƒç”¨stopåœæ­¢æ—‹è½¬å¹¶ä¼ é€’ä¸­å¥–ç´¢å¼•
        this.$refs.myLucky.stop(index)
      }, 2000)
    },
    // æŠ½å¥–ç»“æŸä¼šè§¦å‘endå›è°ƒ
    endCallback (prize) {
      // åŠ è½½æ•°æ®
      // å±•ç¤ºå¥–å“
      this.queryRaffleAwardListHandle()
      // this.remainTimes -= 1
      // this.buttons[0].fonts[0] = { text: `å‰©ä½™æ¬¡æ•°${this.remainTimes}` }
      alert('æ­å–œæŠ½ä¸­å¥–å“ğŸ’ã€' + prize.fonts[0].text + 'ã€‘')
    },
    randomRaffleHandle () {
      const prizeIndex = Math.floor(Math.random() * 8)
      return prizeIndex
    },
    queryRaffleAwardListHandle () {
      console.log('å¥–å“åˆ—è¡¨å‘ç”Ÿäº†å˜æ›´')
    }
  }
}
</script>
